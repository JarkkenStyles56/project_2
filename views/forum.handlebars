{{> navbar user}}

<div class="container">
    <div class="row">
        <div class="col-md">
            <div class="jumbotron">
                <h4 class="display-6 text-center">Welcome {{user.email}}!</h4>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md">

            <div id="forum-posts">
                {{#each posts}}
                <div class="forum-post-card card text-white bg-primary mb-3">
                    <div class="card-header">
                        <h4 class="text-white"> <a href="/articles/{{id}}">{{title}}</a></h4>
                    </div>
                    <img class="float-left" src="{{image}}">
                    <div class="card-body">

                        <p class="card-text text-center">{{truncated}}</p>
                        p class="float-right">by {{'User.email'}}</p>
                        

                    </div>
                </div>
                {{/each}}
            </div>
        </div>


    </div>

    <br>


    <fieldset>
        <legend>Create Your Own Post</legend>
        <p>
            Type in your post title and body below, and click submit to send it to our database. We will
            register it with your email address, and display it above with everyone else's posts!</p>
        </p>

        <div class="form-group">
            <label for="title-input">Title</label>
            <input type="text" class="form-control" id="title-input" aria-describedby="postHelp"
                placeholder="Enter your post title">
            <small id="postHelp" class="form-text text-muted">This'l be shared!</small>
        </div>


        <h3>Select your content type</h3>
        <input type="radio" id="article" name="articleType" value="article">
        <label for="article">Article</label>

        <input type="radio" id="review" name="articleType" value="review">
        <label for="review">Review</label>

        <div id="hide" class="hide">
            <label for="cars">Choose a car:</label>

            <select name="cars" id="cars">
                <option value="volvo">Volvo</option>
                <option value="saab">Saab</option>
                <option value="mercedes">Mercedes</option>
                <option value="audi">Audi</option>
            </select>

        </div>

        <div class="form-group">
            <label for="title-input">Title</label>
            <input type="text" class="form-control" id="title-input" aria-describedby="postHelp"
                placeholder="Enter your post title">
            <small id="postHelp" class="form-text text-muted">This'l be shared!</small>
        </div>

        <div class="form-group">
            <label for="image-input">Image URL</label>
            <input type="text" class="form-control" id="image-input" aria-describedby="postHelp"
                placeholder="Enter your image url here!">
            <small id="postHelp" class="form-text text-muted">Make it shiny!</small>
        </div>
        <div class="form-group">
            <label for="body-input">Body</label>
            <textarea class="form-control" id="body-input" name="body" placeholder="Enter your post body"></textarea>
        </div>
        <button type="submit" id="submit" class="btn btn-primary">Post!</button>
    </fieldset>
    </form>
    <br />
</div>
</div>
</div>

<script>


    $(document).ready(function () {
        // Getting references to our form and inputs

        const postForm = $("form.forum-post");
        const titleInput = $("input#title-input");
        const imageInput = $("input#image-input");
        const bodyInput = $("textarea#body-input");


        $("#submit").click(function (event) {
            event.preventDefault();
            console.log(postForm)
            console.log(titleInput)
            console.log(imageInput)
            console.log(bodyInput)
            let title = titleInput.val().trim();
            let image = imageInput.val().trim();
            let body = bodyInput.val().trim();
            $.ajax({
                method: 'POST',
                url: '/api/posts',
                data: {
                    body: body,
                    title: title,
                    image: image
                }
            }).then(results => {
                console.log('posted');
            })
        })


    });




</script>